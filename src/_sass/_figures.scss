.figure {
	//figure-container with fig ID
	pointer-events: none;
	position: fixed;
	top: 0;
	width: 50%;
	// left: 50vw;
	left: 0vw;
	height: var(--height-figure);
	display: flex;
	align-items: center;
	justify-content: center;
	padding: var(--height-header) 0 var(--pad-body) 0;
	max-width: calc(var(--max-width)/2);

	@include at-media(tablet) {
		pointer-events: auto;
		position: relative;
		left: 0;
		display: block;
		height: auto;
		width: 100%;
		max-width: none;
		padding: 0;
		margin: calc(var(--lineheight)*2) 0;
	}

	figure {
		left: 0;
		opacity: 0;
		transition: opacity 400ms ease-in-out;
		width: 100%;
		padding: 0 var(--pad-section);

		@include at-media(tablet_lg) {
			padding-left: var(--pad-body);
			padding-right: var(--pad-body);
			margin: 0 auto;
		}

		@include at-media(tablet) {
			opacity: 1;
			width: 70%;
		}

		@include at-media(mobile_lg) {
			width: 100%;
		}
	}


	&.image {
		figure {
			display: flex;
			flex-direction: column;
			align-items: center;
		}

		img {
			object-fit: contain;
			object-position: left bottom;
			// height: auto;
			width: auto;
			max-width: 100%;
			max-height: 70vh;
			width: 100%;
			display: block;
		}

		figcaption {
			text-align: left;
			line-height: 1.3; // overwrite plot .figarea line-height
			width: 100%; // for audio (center-aligned)
			letter-spacing: 0.01em;
		}
	}
}



figcaption {
	@extend .serif;
	font-size: var(--caption-size);
	padding: var(--pad-sm) 0;
	line-height: 1.2;
	letter-spacing: 0.01em;

	em {
		@extend .serif;

	}
}

.active-fig {
	z-index: 500;
	pointer-events: auto;

	figure {
		opacity: 1;
	}
}


/*-----------------------------------------*/
/* INDICATORS for active images -----------*/
/*-----------------------------------------*/
.fixed-indicator {
	position: fixed;
	width: calc(var(--width-ind));
	height: 1px;
	background: rgb(125 125 125);
	top: 50vh;
	left: 50vw;
	z-index: 510;
	opacity: 0;

	@include at-media(tablet) {
		left: 0;
		width: var(--width-ind);
		display: none;
	}
}

[data-figstatus="figactive"] .fixed-indicator {
	opacity: 1;
}

[data-figstatus="figactive-full"] .fixed-indicator {
	//fullbleed images and plots
	left: 0;
}

[data-figstatus="figactive-full-visible"] .fixed-indicator {
	//fullbleed images and plots
	left: 0;
	opacity: 1;
}

.figure-indicators {
	position: absolute;
	left: 50vw;
	top: 0;
	width: var(--width-ind);
	height: 100%;
	z-index: 500;

	@include at-media(tablet) {
		display: none;
	}
}

.indicator {
	display: flex;
	flex-direction: column;
	position: absolute;
	width: 100%;
	border-left: 1px dashed var(--gridline);
	// border-left: 0px;

	overflow: hidden;

	&.active-figindicator {
		border-left-style: solid;
		// border-color: var(--accent);
	}

	@include at-media(tablet) {
		border-left-color: transparent;
	}
}

/*full-bleed container*/
.fullbleed {
	.figure {
		display: block;
		position: relative;
		left: 0;
		pointer-events: auto;
		padding: 0;
		margin-top: var(--pad-section);
		margin-bottom: var(--pad-section);

		height: auto;
		width: 100%;
		max-width: none;

		// display: flex;
		// align-items: flex-start;

		figure {
			padding: 0;

			@include at-media(tablet_lg) {
				padding-left: 0;
			}

			@include at-media(tablet) {
				width: 100%;
			}

			img {
				margin: auto;
				max-height: none;
			}
		}

		figcaption {
			margin: 0 var(--margin);
			width: auto;
			// text-align: center;
		}
	}

	.media-full {
		position: relative;

		figure {
			position: static;
			width: 100%; // keep it for tablet
			align-items: normal;
		}

		.indicator {
			position: absolute;
			top: 0;
			left: 0;
			height: 100%;
			border-color: transparent;
		}
	}

}



/* NAV THUBMANILS -----------------------------------------------*/

nav ul.toc li a.thb {
	display: inline-block;
	padding: 0;
	padding-left: 0;
	border-bottom: 0;
}

.toc-thumbnails {
	display: flex;
	flex-wrap: wrap;

	img {
		height: 70px;
		padding: 0 var(--pad-sm) var(--pad-sm) 0;
	}
}

/* ARTICLES -----------------------------------------------------*/

// image: single 
.figarea {
	scroll-margin-top: 49vh; //anchor offset
	position: relative;
	.text-img  {
		margin-left: 50%;
		width: var(--width-text);
		line-height: var(--lineheight);
		text-indent: var(--indent);
		padding-left: var(--pad-body);
		p {
			margin-left: 0;
			width: auto;
			padding-left:0;
		}
	}
	@include at-media(tablet) {
		scroll-margin-top: 0;
	}
}

.figure {
	@include at-media(tablet) {
		scroll-margin-top: calc(var(--height-header) + var(--pad-body));
	}
}

//image: size parameters 

.image {

	&.sm figure,
	figure.sm {

		//default, crossfade
		img,figcaption {
			width: 50%;

			@include at-media(tablet) {
				width: 100%;
			}
		}
	}

	&.md figure,
	figure.md {

		//default, crossfade
		img,figcaption { //important
			width: 80%;

			@include at-media(tablet) {
				width: 100%;
			}
		}
	}
}

.text-crossfade.reverse {
	order: 2;
}


// image: multi-columns

.col-2 {
	display: flex;

	figure {
		display: inline-block;
		width: 50%;

		&:first-child {
			padding-right: 1rem;
		}

		&:last-child {
			padding-left: 1rem;
		}
	}
}



/* IMAGE ANIMATION XFADE / CROSSFADES ---------
--------------------------------------------*/
.crossfade {
	opacity: 0;
	transition: opacity 400ms ease-in-out;
 
	&.active-fig {
		opacity: 1;

		figure {
			opacity: 0;
			transition: none;
			

			&:first-child {
				opacity: 1;
			}


		}
	}

	.xfade-images {
		position: relative;
		width: 100%;
		height: calc(var(--height-figure));

		@include at-media(tablet) {
			width: 80%;
			margin: 0 auto;
		}

		@include at-media(mobile_lg) {
			width: 100%;
		}
	}

	figure {
		top: 0;
		position: absolute;
		height: 100%;
		justify-content: center;
		align-content: center;
		background-color: white;
		width: 100%;


	}

	&.figure.image {
		justify-content: center;

		img {
			max-height: 70vh; //important for mandelcurve
		}
	}

	&.multi_caption figcaption {
		transition: opacity 400ms ease-in-out;
		// opacity: 0;
		min-height: 78px; //set 2 lines in default for a consistent vertical loc across imgs
	}

	.mobile-seqindicator {
		position: relative;
	}

}

//setup figcaption displays separately for crossfades
//so that text doesnâ€™t overlap
@for $i from 0 through 10 {
	.multi_caption[data-active-fade="#{$i}"] [data-xfadeindex="#{$i}"] figcaption {
		opacity: 1;
	}
}


.scroll-overlay {
	scroll-snap-type: y mandatory;
	scroll-snap-align: center;
	position: relative;
	z-index: 600;
	-webkit-transform: translate3d(0, 0, 0); //Fix mobile Safari z-index issue
	pointer-events: none;
	background: transparent;
	min-height: calc(var(--height-figure));
	height: auto;
	margin: 0;
	padding-bottom: var(--height-figure);


	>p,
	>ul,
	>ol,
	>blockquote {
		margin: 0;
		width: 100%;
		pointer-events: auto;
		display: block;
		background: white;
		border-bottom: 1px solid var(--darkgrey);
		border-right: 0;
		border-left: 0;
		padding: var(--pad-body);
	}

	>ul:first-child,
	>ol:first-child,
	>blockquote:first-child,
	>p:first-child {
		border-top: 1px solid var(--darkgrey);
	}

	ol p,
	ul p,
	blockquote p {
		width: auto;
		background: inherit;
	}

	blockquote p {
		margin-left: 0;
	}
}

.xfade-wrapper {
	@include at-media(tablet) {
		padding-top: 0;
		height: auto; //expand to length with mobile indicators

		.figure {
			opacity: 1;
			position: sticky;
			// top: calc(var(--height-figure)*.2);
			top: var(--height-header);
		}

		.figure+.text-img {
			position: relative;
			z-index: 700;

			>p,
			>ol,
			>blockquote {
				display: none;
			}
		}
	}
}

.spanindicator {
	flex: 1;
	// border: 3px solid green;
}

.xfadeindicator {
	background: transparent;
	border-bottom: 1px solid var(--grey);
	width: 10px;

	&:last-child {
		border-bottom: 0;
	}

	@include at-media(tablet) {
		display: none;
		// visibility: hidden;
		//show mobile indicators instead
	}
}

/*----------------
FIGURES-specific OVERRIDES
-----------------*/

#ashby-img{ //vertical long ratio
	width: 60%;
}
#piston-img {
	img,figcaption{ // scale sync with #watt
		width: 63%;
}
}

#newcomen-watt-fig .xfade-images{
	width: 80%;
}

#catscradlevideo-media figcaption {
	margin-top: -40px;
}

#britain .britain {
	img,figcaption {
		width: 80%;
	}
}

#mandelcurve-fig,
#mandelbrot67-fig {
	figcaption {//match the caption height to smooth trantionsion between
		 height: 50px;
	}
}



